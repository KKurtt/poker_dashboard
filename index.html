<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GPC Poker League - 能力互评</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600&family=Noto+Serif+SC:wght@300;500;700&family=Space+Mono:ital,wght@0,400;0,700;1,400&display=swap"
          rel="stylesheet">

    <style>
        :root {
            /* ============================================================
               【配色控制台】在这里调整全局绿色浓度
               ============================================================ */
            --theme-hue: 40;
            --theme-hue-panel: 140;
            --theme-sat: 8%;
            --bg-l-deep: 1%;
            --bg-l-panel: 5%;

            /* 基于上述参数生成的颜色 */
            --bg-deep: hsl(var(--theme-hue), var(--theme-sat), var(--bg-l-deep));
            --bg-panel: hsla(var(--theme-hue-panel), var(--theme-sat), var(--bg-l-panel), 0.85);
            --glow-color: hsla(var(--theme-hue), 20%, 20%, 1);
            --border-color: rgba(180, 160, 120, 0.15);
            --border-highlight: rgba(197, 160, 89, 0.5);
            --accent-gold: #C5A059;
            --accent-glow: rgba(197, 160, 89, 0.2);
            --text-main: #d0d0d0;
            --text-muted: #707570;
            --font-heading: 'Cinzel', 'Noto Serif SC', 'Songti SC', serif;
            --font-data: 'Space Mono', 'PingFang SC', 'Microsoft YaHei', sans-serif;
            --header-height: 70px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: var(--font-data);
            background-color: var(--bg-deep);
            color: var(--text-main);
            line-height: 1.6;
            overflow-x: hidden;
            padding-bottom: 100px;
            position: relative;
        }

        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 50% 0%, var(--glow-color) 0%, var(--bg-deep) 70%);
            z-index: -1;
            pointer-events: none;
            opacity: 0.6;
        }

        /* --- 顶部悬浮栏 (修正版) --- */
        .sticky-header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: var(--header-height);
            background: rgba(5, 5, 5, 0.95);
            border-bottom: 1px solid var(--border-color);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            transform: translateY(-100%);
            transition: transform 0.5s cubic-bezier(0.16, 1, 0.3, 1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8);
        }

        .sticky-header.visible {
            transform: translateY(0);
        }

        .sticky-logo {
            height: 40px;
            width: auto;
            display: block;
        }

        .sticky-select-wrapper {
            flex-grow: 1;
            display: flex;
            justify-content: flex-end;
        }

        /* [修正] 新增容器，用于定位箭头 */
        .sticky-select-container {
            position: relative;
            display: flex;
            align-items: center;
        }

        /* [修正] 右上角下拉框样式优化 */
        .sticky-select {
            appearance: none;
            -webkit-appearance: none; /* 移除iOS默认样式 */
            background: transparent;
            color: var(--accent-gold);
            border: 1px solid var(--border-color);
            padding: 6px 25px 6px 12px; /* 右侧留出箭头空间 */
            font-family: var(--font-heading);
            font-size: 0.85rem;
            outline: none;
            border-radius: 0;
            width: auto;
            /*max-width: 10px; !* 限制最大宽度 *!*/
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }

        /* [修正] 右上角的手动箭头 */
        .sticky-select-container::after {
            content: '▼';
            font-size: 0.5rem;
            color: var(--accent-gold);
            position: absolute;
            right: 8px;
            pointer-events: none;
        }

        /* --- 主容器 --- */
        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 1;
        }

        header {
            text-align: center;
            margin-bottom: 60px;
            padding-top: 20px;
            position: relative;
        }

        header::after {
            content: "";
            display: block;
            width: 1px;
            height: 50px;
            background: linear-gradient(to bottom, transparent, var(--accent-gold), transparent);
            margin: 25px auto 0;
            opacity: 0.3;
        }

        .main-logo-wrapper {
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
        }

        .main-logo {
            max-width: 220px;
            height: auto;
        }

        h1 {
            font-family: var(--font-heading);
            font-size: 2.2rem;
            color: var(--text-main);
            text-transform: uppercase;
            letter-spacing: 0.15em;
            margin-bottom: 10px;
            font-weight: 500;
            text-shadow: 0 0 20px rgba(197, 160, 89, 0.1);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.6rem;
                letter-spacing: 0.1em;
            }
        }

        .subtitle {
            font-family: var(--font-heading);
            color: var(--text-muted);
            font-size: 1.5rem;
            letter-spacing: 0.1em;
        }

        /* 主选择器 */
        .selector-wrapper {
            display: flex;
            justify-content: center;
            margin-bottom: 50px;
            position: relative;
            z-index: 10;
        }

        .custom-select {
            position: relative;
            width: 100%;
            max-width: 320px;
        }

        .custom-select select {
            appearance: none;
            -webkit-appearance: none;
            width: 100%;
            font-family: var(--font-heading);
            font-size: 1.1rem;
            letter-spacing: 0.1em;
            padding: 15px 20px;
            background-color: rgba(0, 0, 0, 0.5);
            border: 1px solid var(--border-color);
            color: var(--accent-gold);
            cursor: pointer;
            outline: none;
            transition: all 0.4s ease;
            text-align: center;
            border-radius: 0;
        }

        .custom-select select:hover {
            border-color: var(--border-highlight);
            box-shadow: 0 0 15px var(--accent-glow);
        }

        .custom-select::after {
            content: '▼';
            font-size: 0.7rem;
            color: var(--accent-gold);
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none;
        }

        /* --- 仪表盘 --- */
        .dashboard {
            display: grid;
            grid-template-columns: 1fr;
            gap: 40px;
        }

        @media (min-width: 900px) {
            .dashboard {
                grid-template-columns: 1fr 1fr;
                gap: 50px;
            }

            .full-width {
                grid-column: span 2;
            }
        }

        .card {
            background: var(--bg-panel);
            border: 1px solid var(--border-color);
            padding: 30px;
            position: relative;
            transition: border-color 0.3s;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.6);
        }

        .card::before, .card::after {
            content: "";
            position: absolute;
            width: 8px;
            height: 8px;
            border: 1px solid var(--accent-gold);
            transition: all 0.3s;
            opacity: 0.5;
        }

        .card::before {
            top: -1px;
            left: -1px;
            border-right: none;
            border-bottom: none;
        }

        .card::after {
            bottom: -1px;
            right: -1px;
            border-left: none;
            border-top: none;
        }

        .card:hover {
            border-color: var(--border-highlight);
        }

        .card-title {
            font-family: var(--font-heading);
            color: var(--text-main);
            font-size: 1.2rem;
            margin-bottom: 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            padding-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            flex-wrap: wrap;
            gap: 10px;
            letter-spacing: 0.05em;
            font-weight: 500;
        }

        .card-sub {
            font-family: var(--font-data);
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0;
        }

        .rolling-number {
            font-family: 'Space Mono', monospace;
            color: var(--accent-gold);
        }

        .chart-container {
            position: relative;
            height: 320px;
            width: 100%;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 380px;
            }
        }

        .scatter-wrapper {
            position: relative;
            height: 320px;
            width: 100%;
            padding: 20px;
        }

        @media (min-width: 768px) {
            .scatter-wrapper {
                height: 380px;
            }
        }

        .quadrant-label {
            position: absolute;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            color: var(--text-muted);
            font-size: 11px;
            pointer-events: none;
            z-index: 10;
            font-family: var(--font-data);
            letter-spacing: 1px;
            opacity: 0.7;
        }

        .axis-arrow {
            width: 30px;
            height: 8px;
            fill: none;
            stroke: var(--text-muted);
            stroke-width: 1;
            opacity: 0.5;
        }

        .q-bottom {
            bottom: 0;
            left: 0;
            width: 100%;
        }

        .q-left {
            top: 50%;
            left: 0;
            transform: translate(-42%, -50%) rotate(-90deg);
            transform-origin: center center;
            width: auto;
            white-space: nowrap;
        }

        /* Data Breakdown */
        .detail-rows {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .detail-row {
            display: flex;
            flex-direction: column;
            padding-bottom: 5px;
        }

        .row-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-bottom: 12px;
        }

        .d-label {
            font-family: var(--font-heading);
            font-size: 1rem;
            color: var(--text-main);
            letter-spacing: 0.1em;
            font-weight: 300;
        }

        .d-stats {
            font-size: 0.75rem;
            color: var(--text-muted);
            font-family: var(--font-data);
        }

        .stat-item {
            display: inline-block;
            margin-left: 15px;
        }

        .stat-label-small {
            font-size: 0.7rem;
            opacity: 0.6;
            margin-right: 2px;
        }

        .stat-val {
            color: var(--text-main);
            font-weight: 400;
        }

        .stat-gap {
            color: var(--accent-gold);
        }

        .d-track-container {
            position: relative;
            width: 100%;
            height: 20px;
            display: flex;
            align-items: center;
        }

        .d-track-line {
            width: 100%;
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
        }

        .detail-point {
            position: absolute;
            top: 50%;
            transform: translate(-50%, -50%);
            transition: left 1.5s cubic-bezier(0.22, 1, 0.36, 1);
        }

        .detail-point.peer {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.2);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.8);
            z-index: 1;
        }

        .detail-point.self {
            width: 9px;
            height: 9px;
            background: var(--accent-gold);
            transform: translate(-50%, -50%) rotate(45deg);
            border: 1px solid #000;
            z-index: 2;
            box-shadow: 0 0 8px var(--accent-glow);
        }

        .ai-advice {
            font-family: var(--font-data);
            font-size: 0.9rem;
            color: #a0a0a0;
            line-height: 1.9;
            border-left: 1px solid var(--accent-gold);
            padding-left: 25px;
            margin-left: 5px;
            /* === 新增动效优化 === */
            transition: opacity 0.4s cubic-bezier(0.22, 1, 0.36, 1),
            transform 0.4s cubic-bezier(0.22, 1, 0.36, 1);
            opacity: 1;
            transform: translateY(0);
        }

        .ai-advice strong {
            color: var(--accent-gold);
            font-weight: 400;
            font-family: var(--font-heading);
            letter-spacing: 0.05em;
        }

        .ai-advice p {
            margin-bottom: 15px;
            text-align: justify;
        }

        .ai-advice ul {
            padding-left: 15px;
            margin-bottom: 15px;
            list-style-type: none;
        }

        .ai-advice li {
            margin-bottom: 8px;
            color: var(--text-muted);
            position: relative;
            padding-left: 15px;
        }

        .ai-advice li::before {
            content: ">";
            position: absolute;
            left: -5px;
            color: var(--accent-gold);
            font-size: 0.8rem;
        }

        footer {
            height: 100px;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0.3;
            font-size: 0.7rem;
            font-family: var(--font-data);
            letter-spacing: 2px;
        }

        /* --- 自定义图例样式 --- */
        .custom-chart-legend {
            position: absolute;
            top: 5px;
            right: 26px;
            display: flex;
            gap: 20px;
            z-index: 20; /* 确保在 Canvas 之上 */
            pointer-events: none; /* 防止挡住鼠标与图表的交互 */
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: var(--font-heading);
            font-size: 0.75rem;
            color: var(--text-muted);
            letter-spacing: 1px;
        }

        .legend-icon {
            width: 8px;
            height: 8px;
        }

        /* 自评图标：金色菱形 */
        .legend-icon.icon-self {
            background-color: var(--accent-gold);
            transform: rotate(45deg);
            box-shadow: 0 0 5px var(--accent-glow);
        }

        /* 队友图标：灰色圆形 */
        .legend-icon.icon-peer {
            background-color: #f1f1f1; /* 或者用 #e0e0e0 稍微亮一点 */
            border-radius: 50%;
            opacity: 0.8;
        }

        /* ============================================================
   【审美提升】 动画与效果
   ============================================================ */

        /* --- 1. Keyframes 动画定义 --- */

        /* 标题“呼吸”辉光 */
        @keyframes pulse-text-glow {
            0% {
                text-shadow: 0 0 20px rgba(197, 160, 89, 0.1);
            }
            50% {
                text-shadow: 0 0 35px rgba(197, 160, 89, 0.4);
            }
            100% {
                text-shadow: 0 0 20px rgba(197, 160, 89, 0.1);
            }
        }

        /* “自评”数据点脉冲 */
        @keyframes pulse-gold {
            0% {
                transform: translate(-50%, -50%) rotate(45deg) scale(1);
                box-shadow: 0 0 8px var(--accent-glow);
                background-color: var(--accent-gold);
            }
            50% {
                transform: translate(-50%, -50%) rotate(45deg) scale(1.4);
                box-shadow: 0 0 18px var(--accent-glow);
                background-color: #f0e0b0; /* 闪烁至白金色 */
            }
            100% {
                transform: translate(-50%, -50%) rotate(45deg) scale(1);
                box-shadow: 0 0 8px var(--accent-glow);
                background-color: var(--accent-gold);
            }
        }

        /* --- 2. 应用动画与效果 --- */

        /* 为 body::before 叠加一层微妙的“扫描线”纹理 */
        body::before {
            background: radial-gradient(circle at 50% 0%, var(--glow-color) 0%, var(--bg-deep) 70%),
                /* 新增：微妙的扫描线纹理 */ repeating-linear-gradient(
                    to bottom,
                    transparent 0,
                    rgba(255, 255, 255, 0.02) 1px,
                    transparent 3px
            );
        }

        /* 1. 为 H1 标题添加“呼吸”辉光 */
        h1 {
            animation: pulse-text-glow 4s infinite alternate;
        }

        /* 2. 增强卡片 (Card) 的交互动效 */
        .card {
            /* 为 transition 增加 transform 和 box-shadow */
            transition: border-color 0.4s ease,
            transform 0.4s cubic-bezier(0.22, 1, 0.36, 1),
            box-shadow 0.4s cubic-bezier(0.22, 1, 0.36, 1);
        }

        .card:hover {
            border-color: var(--border-highlight);
            /* 动效：更强的辉光 */
            box-shadow: 0 25px 40px rgba(0, 0, 0, 0.8), /* 底部阴影加深 */ 0 0 20px var(--accent-glow); /* 金色辉光 */
        }

        /* 3. 卡片边角在悬停时也一起发光 */
        .card:hover::before, .card:hover::after {
            opacity: 1;
            border-color: var(--accent-gold);
            box-shadow: 0 0 10px var(--accent-glow);
        }

        /* 4. 为主选择器添加 :focus 状态，使其在激活时发光 */
        .custom-select select:hover,
        .custom-select select:focus {
            border-color: var(--border-highlight);
            box-shadow: 0 0 15px var(--accent-glow);
        }

        /* 5. 让“评分分布细节”中的“自评”点产生脉冲，突出显示 */
        .detail-point.self {
            /* 增加动画 */
            animation: pulse-gold 2.5s infinite cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* 6. 让“他评”的圆点更大更清晰 */
        .detail-point.peer {
            width: 6px;
            height: 6px;
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.2);
        }

        /* 7. 让“自评”的菱形也更大 */
        .detail-point.self {
            width: 9px;
            height: 9px;
        }

        /* ============================================================
   【外观蜕变】 玻璃拟态 (Glassmorphism)
   ============================================================ */

        /* --- 1. 赋予卡片“磨砂玻璃”质感 --- */
        .card {
            /* 关键：
              1. 降低背景不透明度，让背景光透进来
              2. 添加 backdrop-filter 来模糊背景
              3. 更改边框为“玻璃亮边”
            */
            background: hsla(var(--theme-hue-panel), var(--theme-sat), var(--bg-l-panel), 0.65); /* 0.85 -> 0.65 */
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px); /* 兼容 Safari */

            border: 1px solid rgba(255, 255, 255, 0.1); /* 更改为玻璃亮边 */

            /* 增强悬停时的“辉光”而非“阴影” */
            transition: border-color 0.4s ease,
            transform 0.4s cubic-bezier(0.22, 1, 0.36, 1),
            box-shadow 0.4s cubic-bezier(0.22, 1, 0.36, 1);
        }

        /* 悬停时，取消厚重的黑色阴影，只保留“上浮”和“辉光” */
        .card:hover {
            box-shadow: 0 0 25px var(--accent-glow); /* 移除黑色阴影，只留辉光 */
            border-color: var(--border-highlight);
        }

        /* 卡片边角改为低调的亮白色，悬停时再变为金色 */
        .card::before, .card::after {
            border-color: rgba(255, 255, 255, 0.25);
            opacity: 0.8;
        }

        .card:hover::before, .card:hover::after {
            border-color: var(--accent-gold);
        }


        /* --- 2. 顶部悬浮栏也变为“玻璃” --- */
        .sticky-header {
            background: hsla(0, 0%, 5%, 0.75); /* 0.95 -> 0.75 */
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1); /* 统一边框 */
        }


        /* --- 3. 中间的主选择器也“玻璃化” --- */
        /*.custom-select select {*/
        /*    background-color: rgba(0, 0, 0, 0.2); !* 0.5 -> 0.2 *!*/
        /*    backdrop-filter: blur(5px);*/
        /*    -webkit-backdrop-filter: blur(5px);*/
        /*    border: 1px solid rgba(255, 255, 255, 0.1);*/
        /*}*/


        /* --- 4. [点睛之笔] 赋予标题“金属渐变”质感 --- */
        h1 {
            /* 使用渐变作为文字颜色 */
            background: linear-gradient(145deg,
            #ffffff 20%,
            var(--accent-gold) 80%
            );
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            color: transparent; /* Fallback */
            animation: pulse-text-glow 4s infinite alternate; /* 保持呼吸辉光 */
        }

        .subtitle {
            /* 副标题也使用更低调的渐变 */
            background: linear-gradient(145deg,
            #d0d0d0 30%,
            #707570 90%
            );
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            color: transparent;
        }
    </style>
</head>
<body>

<div class="sticky-header" id="stickyHeader">
    <img src="logo_sticky.png" alt="GPC Logo" class="sticky-logo">
    <div class="sticky-select-wrapper">
        <!-- [修正] 增加了一层容器 sticky-select-container -->
        <div class="sticky-select-container">
            <select id="stickyPlayerSelect" class="sticky-select"></select>
        </div>
    </div>
</div>

<div class="container">
    <header id="mainHeader">
        <div class="main-logo-wrapper">
            <img src="logo_main.png" alt="GPC Main Logo" class="main-logo">
        </div>
        <h1>GPC POKER LEAGUE</h1>
        <div class="subtitle">S1 赛季能力互评报告</div>
    </header>

    <div class="selector-wrapper">
        <div class="custom-select">
            <select id="playerSelect"></select>
        </div>
    </div>

    <div class="dashboard" id="dashboard">

        <!-- 1. 雷达图 -->
        <div class="card">
            <div class="card-title">
                综合能力雷达
                <span class="card-sub">Radar Analysis</span>
            </div>
            <div class="chart-container">
                <canvas id="radarChart"></canvas>
            </div>
        </div>

        <!-- 2. 象限图 -->
        <div class="card">
            <div class="card-title">
                选手风格定位
                <span class="card-sub">Player Profiling</span>
            </div>

            <div class="scatter-wrapper">
                <!-- 新增：自定义图例 -->
                <div class="custom-chart-legend">
                    <div class="legend-item">
                        <div class="legend-icon icon-self"></div>
                        <span>自评定位</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-icon icon-peer"></div>
                        <span>他人眼中</span>
                    </div>
                </div>

                <div class="quadrant-label q-bottom">
                    <span>松 (Loose)</span>
                    <svg class="axis-arrow" viewBox="0 0 60 12">
                        <line x1="0" y1="6" x2="60" y2="6"/>
                    </svg>
                    <span>紧 (Tight)</span>
                </div>
                <div class="quadrant-label q-left">
                    <span>弱 (Passive)</span>
                    <svg class="axis-arrow" viewBox="0 0 60 12">
                        <line x1="0" y1="6" x2="60" y2="6"/>
                    </svg>
                    <span>凶 (Aggressive)</span>
                </div>
                <canvas id="scatterChart"></canvas>
            </div>

            <div id="profileText"
                 style="margin-top:20px; text-align:center; color:var(--accent-gold); font-family: var(--font-heading); font-size: 1rem; letter-spacing: 0.1em; min-height: 1.6em;"></div>
        </div>

        <!-- 3. 评分细节 -->
        <div class="card full-width">
            <div class="card-title" style="display: flex; justify-content: space-between; align-items: center;">
                <span>评分分布细节</span>
                <div class="card-sub" style="display: flex; align-items: center;">
                    <span style="font-size: 0.9rem; margin-right: 8px; opacity: 0.7;">
                                认知偏差(MAE):
                    </span>
                    <div style="display: flex; flex-direction: column; align-items: flex-start; line-height: 1.5;">
                        <div>
                            <span style="opacity: 0.6; margin-right: 2px;">[自]</span>
                            <span id="maeValue" class="rolling-number" style="font-weight:bold; font-size: 0.9rem; ">0.00</span>
                        </div>

                        <div>
                            <span style="opacity: 0.6; margin-right: 2px;">[他]</span>
                            <span id="maeOther" class="rolling-number"
                                  style="font-weight:bold; font-size: 0.9rem;">0.00</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="detail-rows" id="detailRows"></div>
        </div>

        <!-- 4. AI 建议 -->
        <div class="card full-width">
            <div class="card-title">AI 战术顾问建议</div>
            <div class="ai-advice" id="aiAdvice"></div>
        </div>

    </div>

    <footer>
        GPC SYSTEM // END OF RECORD
    </footer>
</div>

<script>
    // ============================================================================
    // 数据配置区域
    // ============================================================================

    const dimensions = ["范围构建", "锦标赛ICM", "激进偷盲", "读牌能力", "数学理论", "心态耐力"];

    const playersData = [
{'id': '01 Bbbbbb(疯子)', 'mae': '1.99', 'maeOther': '1.34', 'profileLabel': '综合画像判定：失控的加注机 (Maniac)', 'abilities': [{'self': 4.0, 'others': [3.0, 6.0, 3.0, 7.0, 7.0, 1.0, 7.0, 2.0, 8.0]}, {'self': 7.0, 'others': [5.0, 6.0, 8.0, 4.0, 5.0, 3.0, 7.0, 1.0, 8.0]}, {'self': 9.0, 'others': [9.0, 6.0, 8.0, 9.0, 8.0, 8.0, 9.0, 8.0, 9.0]}, {'self': 10.0, 'others': [4.0, 6.0, 7.0, 8.0, 3.0, 4.0, 8.0, 8.0, 7.0]}, {'self': 8.0, 'others': [4.0, 5.0, 5.0, 7.0, 8.0, 2.0, 7.0, 3.0, 7.0]}, {'self': 3.0, 'others': [2.0, 4.0, 5.0, 5.0, 5.0, 4.0, 9.0, 1.0, 1.0]}], 'profile': {'tightness': {'self': 6.0, 'others': [4.0, 3.0, 3.0, 2.0, 1.0, 1.0, 1.0, 1.0, 8.0]}, 'aggression': {'self': 9.0, 'others': [8.0, 5.0, 9.0, 8.0, 8.0, 7.0, 7.0, 5.0, 10.0]}}, 'aiAdvice': '\n        <p><strong>综合评价：</strong>名副其实的<strong>【疯子】</strong>。你对自己读牌能力的评分是满分（10.0），而大家只给你6.1分。你自认紧度适中（6.0），大家公认你是全场最松（2.6）。你不是在打牌，你是在送钱。</p>\n        <p><strong>战术建议：</strong></p>\n        <ul>\n            <li><strong>强行降速：</strong>你的所有数据都是红色的警报。你需要强制自己每局牌弃牌率达到80%以上。如果做不到，任何技术调整都是徒劳。</li>\n            <li><strong>停止Hero Call：</strong>你以为你是读牌天才，能抓到每一次诈唬，但事实是你支付了所有的强牌。不中牌就弃牌，这对你来说是最赚的策略。</li>\n        </ul>\n    '},
{'id': '02 GW(毒蛇)', 'mae': '2.36', 'maeOther': '2.05', 'profileLabel': '综合画像判定：盲目的喷射机 (Spewy LAG)', 'abilities': [{'self': 10.0, 'others': [3.0, 3.0, 3.0, 3.0, 3.0, 5.0, 1.0, 4.0, 9.0]}, {'self': 5.0, 'others': [4.0, 5.0, 8.0, 9.0, 3.0, 3.0, 2.0, 9.0, 8.0]}, {'self': 6.0, 'others': [7.0, 5.0, 7.0, 8.0, 9.0, 6.0, 8.0, 9.0, 9.0]}, {'self': 2.0, 'others': [4.0, 5.0, 5.0, 5.0, 1.0, 3.0, 2.0, 5.0, 8.0]}, {'self': 2.0, 'others': [3.0, 5.0, 5.0, 7.0, 1.0, 5.0, 1.0, 3.0, 7.0]}, {'self': 2.0, 'others': [2.0, 4.0, 3.0, 3.0, 1.0, 1.0, 1.0, 4.0, 1.0]}], 'profile': {'tightness': {'self': 6.0, 'others': [4.0, 3.0, 3.0, 8.0, 1.0, 1.0, 1.0, 3.0, 7.0]}, 'aggression': {'self': 5.0, 'others': [8.0, 6.0, 8.0, 5.0, 10.0, 8.0, 10.0, 10.0, 10.0]}}, 'aiAdvice': '\n        <p><strong>综合评价：</strong>达克效应（Dunning-Kruger）的最佳案例。你像一条<strong>【毒蛇】</strong>，不仅攻击别人，也常常咬伤自己。你自评“范围构建”满分（10.0），而公认评分只有3.4。这种认知的鸿沟是灾难性的，你自以为在GTO，其实是在乱打。</p>\n        <p><strong>战术建议：</strong></p>\n        <ul>\n            <li><strong>清空归零：</strong>忘掉你那些“高端”的操作。你的基础范围是错的。请从头开始学习<strong>翻前起手牌表</strong>，严格执行，不要有任何创造性发挥。</li>\n            <li><strong>控制攻击欲：</strong>公认激进分高达8.3，说明你在过度诈唬。在没有坚实范围支持的情况下，停止你的Triple Barrel（三枪）。</li>\n        </ul>\n    '},
{'id': '03 暗流(小丑)', 'mae': '1.75', 'maeOther': '1.30', 'profileLabel': '综合画像判定：混乱的伪紧手 (Loose Aggressive)', 'abilities': [{'self': 7.0, 'others': [3.0, 6.0, 5.0, 5.0, 8.0, 3.0, 4.0, 8.0, 9.0]}, {'self': 8.0, 'others': [5.0, 5.0, 8.0, 8.0, 5.0, 10.0, 4.0, 3.0, 8.0]}, {'self': 8.0, 'others': [7.0, 6.0, 8.0, 9.0, 8.0, 8.0, 7.0, 3.0, 9.0]}, {'self': 8.0, 'others': [5.0, 6.0, 7.0, 7.0, 3.0, 4.0, 5.0, 8.0, 7.0]}, {'self': 7.0, 'others': [4.0, 5.0, 5.0, 7.0, 8.0, 6.0, 4.0, 2.0, 7.0]}, {'self': 7.0, 'others': [2.0, 5.0, 4.0, 4.0, 4.0, 5.0, 9.0, 2.0, 1.0]}], 'profile': {'tightness': {'self': 8.0, 'others': [3.0, 5.0, 4.0, 7.0, 5.0, 5.0, 6.0, 6.0, 8.0]}, 'aggression': {'self': 8.0, 'others': [6.0, 6.0, 7.0, 8.0, 9.0, 8.0, 7.0, 5.0, 10.0]}}, 'aiAdvice': '\n        <p><strong>综合评价：</strong><strong>典型的自我认知错位。</strong>你自封“紧手”（自评紧度8.0），但在群众眼里你是到处乱入池的<strong>【小丑】</strong>（公认紧度5.4）。你以为自己在狙击，实际是在扫射。这种形象偏差是你长期漏码的根源。</p>\n        <p><strong>战术建议：</strong></p>\n        <ul>\n            <li><strong>正视现实：</strong>承认吧，你并不紧。你的VPIP（入池率）绝对超标了。请把所有非同花的高张（KJo, QJo）和弱Ax直接从枪口位范围里删掉。</li>\n            <li><strong>激进的质量：</strong>你的激进得分很高（~7.3），但这更多是“鲁莽”而非“施压”。在没有位置和范围优势时，不要盲目且频繁地开枪。</li>\n        </ul>\n    '},
{'id': '04 JinFu(老板)', 'mae': '2.36', 'maeOther': '1.79', 'profileLabel': '综合画像判定：凡尔赛大魔王 (Top Reg)', 'abilities': [{'self': 5.0, 'others': [8.0, 8.0, 4.0, 7.0, 8.0, 5.0, 9.0, 8.0, 9.0]}, {'self': 5.0, 'others': [7.0, 8.0, 8.0, 9.0, 10.0, 3.0, 8.0, 7.0, 8.0]}, {'self': 8.0, 'others': [7.0, 8.0, 8.0, 8.0, 6.0, 6.0, 7.0, 7.0, 9.0]}, {'self': 3.0, 'others': [8.0, 8.0, 8.0, 8.0, 9.0, 4.0, 9.0, 7.0, 8.0]}, {'self': 5.0, 'others': [7.0, 6.0, 5.0, 7.0, 8.0, 5.0, 7.0, 9.0, 7.0]}, {'self': 3.0, 'others': [8.0, 6.0, 5.0, 8.0, 10.0, 7.0, 7.0, 8.0, 3.0]}], 'profile': {'tightness': {'self': 5.0, 'others': [7.0, 6.0, 5.0, 8.0, 9.0, 7.0, 9.0, 6.0, 8.0]}, 'aggression': {'self': 8.0, 'others': [7.0, 8.0, 8.0, 8.0, 5.0, 6.0, 8.0, 5.0, 10.0]}}, 'aiAdvice': '\n        <p><strong>综合评价：</strong><strong>过度的谦虚就是虚伪。</strong>你自评读牌能力3分（全场最低），公认评分却高达7.7分（全场顶尖）。你就是那个掌控全场的<strong>【老板】</strong>，却非要装作一无所知。你的数据是统治级的，你的心态却像个初学者。</p>\n        <p><strong>战术建议：</strong></p>\n        <ul>\n            <li><strong>统治桌子：</strong>既然大家都如此尊重你的技术（公认生存/读牌均为顶尖），你应当利用这份恐惧。在泡沫期疯狂施压，对手会因为觉得“他这么强一定是有牌”而过分弃牌。</li>\n            <li><strong>自信推注：</strong>别再给自己的犹豫找借口。你的直觉比大多数人的计算都准，相信它，执行它。</li>\n        </ul>\n    '},
{'id': '05 Kuo(王牌)', 'mae': '1.18', 'maeOther': '1.50', 'profileLabel': '综合画像判定：无情的碾压者 (Crusher)', 'abilities': [{'self': 9.0, 'others': [9.0, 8.0, 8.0, 9.0, 9.0, 10.0, 8.0, 4.0, 7.0]}, {'self': 8.0, 'others': [8.0, 5.0, 9.0, 6.0, 8.0, 8.0, 10.0, 9.0, 10.0]}, {'self': 9.0, 'others': [7.0, 7.0, 9.0, 8.0, 10.0, 4.0, 9.0, 3.0, 9.0]}, {'self': 7.0, 'others': [8.0, 7.0, 8.0, 8.0, 8.0, 4.0, 8.0, 10.0, 10.0]}, {'self': 8.0, 'others': [10.0, 7.0, 5.0, 8.0, 9.0, 9.0, 9.0, 10.0, 10.0]}, {'self': 3.0, 'others': [10.0, 6.0, 8.0, 8.0, 6.0, 9.0, 8.0, 2.0, 8.0]}], 'profile': {'tightness': {'self': 9.0, 'others': [9.0, 7.0, 8.0, 8.0, 8.0, 9.0, 9.0, 6.0, 8.0]}, 'aggression': {'self': 8.0, 'others': [9.0, 8.0, 8.0, 9.0, 6.0, 10.0, 7.0, 5.0, 10.0]}}, 'aiAdvice': '\n        <p><strong>综合评价：</strong>当之无愧的<strong>【王牌】</strong>。自评高（8-9分），公认更高（8-10分）。你是典型的紧凶大魔王，各项技术指标几乎触顶。你是所有玩家最不想坐在左手边的人。</p>\n        <p><strong>战术建议：</strong></p>\n        <ul>\n            <li><strong>应对针对：</strong>你现在是全场的靶子。聪明的对手会对你过度弃牌（Over-fold）。建议你在翻前混合一些A5s/KXs的3-bet诈唬，因为对手太尊重你的加注了。</li>\n            <li><strong>情绪管理：</strong>心态是你唯一的短板（自评3.0）。当你的完美策略遭遇Bad Beat时，不要上头。记住，运气是技术唯一的克星，接受它。</li>\n        </ul>\n    '},
{'id': '06 LY(狐狸)', 'mae': '0.78', 'maeOther': '1.10', 'profileLabel': '综合画像判定：狡黠的紧弱 (Tight Passive)', 'abilities': [{'self': 7.0, 'others': [6.0, 8.0, 8.0, 6.0, 5.0, 5.0, 5.0, 4.0, 8.0]}, {'self': 7.0, 'others': [6.0, 6.0, 8.0, 8.0, 8.0, 5.0, 7.0, 2.0, 5.0]}, {'self': 6.0, 'others': [4.0, 7.0, 6.0, 4.0, 1.0, 4.0, 4.0, 7.0, 9.0]}, {'self': 6.0, 'others': [6.0, 7.0, 7.0, 6.0, 3.0, 4.0, 5.0, 7.0, 7.0]}, {'self': 5.0, 'others': [7.0, 6.0, 6.0, 9.0, 2.0, 5.0, 4.0, 7.0, 7.0]}, {'self': 5.0, 'others': [6.0, 5.0, 7.0, 9.0, 5.0, 6.0, 7.0, 3.0, 8.0]}], 'profile': {'tightness': {'self': 7.0, 'others': [6.0, 5.0, 8.0, 9.0, 10.0, 6.0, 8.0, 1.0, 8.0]}, 'aggression': {'self': 6.0, 'others': [6.0, 7.0, 8.0, 4.0, 2.0, 6.0, 2.0, 5.0, 5.0]}}, 'aiAdvice': '\n        <p><strong>综合评价：</strong>全场认知最精准的选手（MAE 0.78）。你像一只<strong>【狐狸】</strong>，聪明、审慎，但也有些过于保守。虽然你自评激进6分，但对手公认你只有5.0分。你太想“正确”地打牌，导致缺乏统治力。</p>\n        <p><strong>战术建议：</strong></p>\n        <ul>\n            <li><strong>提升Aggression Factor：</strong>你的“紧”是公认的（~6.8），这意味着你的诈唬成功率极高。不要只等到坚果才行动，试着在Turn和River转守为攻。</li>\n            <li><strong>防守过牌范围：</strong>你目前过于诚实，Check往往代表示弱。学会用听牌和后门花去Check-Raise，否则你会被凶猛的对手随意剥削。</li>\n        </ul>\n    '},
{'id': '07 LZQ(磐石)', 'mae': '1.39', 'maeOther': '1.92', 'profileLabel': '综合画像判定：沉睡的化石 (Nit/Rock)', 'abilities': [{'self': 4.0, 'others': [5.0, 5.0, 8.0, 1.0, 6.0, 5.0, 7.0, 5.0, 7.0]}, {'self': 5.0, 'others': [9.0, 5.0, 7.0, 9.0, 9.0, 8.0, 5.0, 4.0, 8.0]}, {'self': 3.0, 'others': [1.0, 5.0, 5.0, 7.0, 1.0, 1.0, 1.0, 1.0, 3.0]}, {'self': 5.0, 'others': [3.0, 5.0, 6.0, 6.0, 6.0, 3.0, 4.0, 4.0, 8.0]}, {'self': 5.0, 'others': [5.0, 5.0, 5.0, 4.0, 6.0, 2.0, 4.0, 7.0, 8.0]}, {'self': 5.0, 'others': [10.0, 6.0, 5.0, 8.0, 10.0, 5.0, 9.0, 10.0, 3.0]}], 'profile': {'tightness': {'self': 5.0, 'others': [10.0, 5.0, 7.0, 9.0, 10.0, 10.0, 10.0, 10.0, 3.0]}, 'aggression': {'self': 5.0, 'others': [5.0, 5.0, 6.0, 3.0, 2.0, 2.0, 1.0, 1.0, 5.0]}}, 'aiAdvice': '\n        <p><strong>综合评价：</strong>你不是紧，你是<strong>【磐石】</strong>。公认紧度高达8.6（全场最高），公认偷盲能力仅3.3（全场最低）。对手完全看透了你：“不中牌不打，一打就是牌”。你正在被盲注一点点吞噬。</p>\n        <p><strong>战术建议：</strong></p>\n        <ul>\n            <li><strong>必须偷盲：</strong>在锦标赛后期，你的打法是慢性死亡。在后位（CO/BTN）拿到任意同花高张或对子时，必须强制自己加注，而不是平跟或弃牌。</li>\n            <li><strong>C-Bet防守：</strong>因为你形象太好，你在干燥面做持续下注（C-Bet）几乎是印钱的。不要因为没中牌就Check-Fold，大胆地打出去！</li>\n        </ul>\n    '},
{'id': '08 VN(影子)', 'mae': '2.07', 'maeOther': '1.04', 'profileLabel': '综合画像判定：隐秘的杀手 (Underrated TAG)', 'abilities': [{'self': 4.0, 'others': [7.0, 5.0, 7.0, 6.0, 5.0, 7.0, 7.0, 4.0, 8.0]}, {'self': 4.0, 'others': [8.0, 8.0, 7.0, 6.0, 5.0, 8.0, 5.0, 7.0, 7.0]}, {'self': 4.0, 'others': [7.0, 8.0, 6.0, 7.0, 5.0, 7.0, 7.0, 7.0, 8.0]}, {'self': 4.0, 'others': [7.0, 5.0, 7.0, 6.0, 3.0, 4.0, 7.0, 8.0, 8.0]}, {'self': 5.0, 'others': [5.0, 5.0, 7.0, 6.0, 5.0, 5.0, 7.0, 9.0, 7.0]}, {'self': 4.0, 'others': [6.0, 4.0, 7.0, 4.0, 4.0, 6.0, 8.0, 7.0, 8.0]}], 'profile': {'tightness': {'self': 5.0, 'others': [7.0, 5.0, 7.0, 6.0, 5.0, 6.0, 8.0, 5.0, 8.0]}, 'aggression': {'self': 5.0, 'others': [7.0, 7.0, 7.0, 8.0, 8.0, 6.0, 8.0, 5.0, 7.0]}}, 'aiAdvice': '\n        <p><strong>综合评价：</strong><strong>德州扑克不需要怯懦！</strong>你给自己全线打4分，而公认评分却高达7-8分。这种极度的自我低估（MAE 2.07）是严重的EV泄漏。你像一道<strong>【影子】</strong>，明明有击杀全场的能力，却总在关键时刻因为不自信而缩手缩脚。</p>\n        <p><strong>战术建议：</strong></p>\n        <ul>\n            <li><strong>停止自我设限：</strong>在对手眼里你已经是一条鲨鱼了，不要再用鱼的思维打牌。当你的读牌告诉你“由于对手范围封顶我可以推All-in”时，不要因为“我觉得我只有4分水平”而弃牌。</li>\n            <li><strong>薄价值获取：</strong>你的谦虚导致你错过了大量的薄价值下注。请记住：如果你从未在河牌被抓鸡，说明你下注得不够多！</li>\n        </ul>\n    '},
{'id': '09 ysc(机器)', 'mae': '0.99', 'maeOther': '1.02', 'profileLabel': '综合画像判定：稳健平衡型 (Standard TAG)', 'abilities': [{'self': 6.0, 'others': [5.0, 7.0, 8.0, 6.0, 7.0, 4.0, 8.0, 8.0, 8.0]}, {'self': 4.0, 'others': [5.0, 8.0, 8.0, 7.0, 3.0, 7.0, 8.0, 5.0, 7.0]}, {'self': 5.0, 'others': [5.0, 8.0, 8.0, 8.0, 5.0, 6.0, 5.0, 3.0, 8.0]}, {'self': 6.0, 'others': [5.0, 7.0, 8.0, 4.0, 3.0, 4.0, 8.0, 5.0, 7.0]}, {'self': 5.0, 'others': [5.0, 5.0, 6.0, 6.0, 5.0, 5.0, 7.0, 5.0, 7.0]}, {'self': 5.0, 'others': [5.0, 5.0, 8.0, 3.0, 4.0, 4.0, 8.0, 6.0, 8.0]}], 'profile': {'tightness': {'self': 6.0, 'others': [5.0, 7.0, 9.0, 7.0, 5.0, 6.0, 8.0, 5.0, 8.0]}, 'aggression': {'self': 8.0, 'others': [5.0, 7.0, 8.0, 9.0, 9.0, 8.0, 4.0, 5.0, 7.0]}}, 'aiAdvice': '\n        <p><strong>综合评价：</strong>你的代号是<strong>【机器】</strong>，因为你的MAE（0.99）显示出你对自己有着极其客观、近乎机械般精准的认知。你是一位标准的Grinder，打法稳健，没有明显的短板，但也没有让对手恐惧的长板。</p>\n        <p><strong>战术建议：</strong></p>\n        <ul>\n            <li><strong>打破平衡：</strong>你的各项数据太“标准”了，这让你在高端局中容易被阅读。建议偶尔在翻前用弱同花连张进行轻微的“过激”操作，扰乱对手对你的频率计算。</li>\n            <li><strong>利用诚实形象：</strong>你自评激进8分，但对手只给你6.9分。利用这个“信息差”，在河牌圈进行超额下注诈唬（Overbet Bluff），对手大概率会因为尊重你的形象而弃牌。</li>\n        </ul>\n    '},
{'id': '10 ZDS(凤凰)', 'mae': '2.29', 'maeOther': '1.43', 'profileLabel': '综合画像判定：悲观的弱被动 (Loose Weak)', 'abilities': [{'self': 1.0, 'others': [4.0, 4.0, 3.0, 3.0, 3.0, 1.0, 3.0, 7.0, 8.0]}, {'self': 2.0, 'others': [5.0, 5.0, 7.0, 8.0, 5.0, 2.0, 3.0, 1.0, 5.0]}, {'self': 3.0, 'others': [7.0, 6.0, 9.0, 6.0, 6.0, 5.0, 4.0, 7.0, 10.0]}, {'self': 8.0, 'others': [8.0, 4.0, 5.0, 6.0, 6.0, 3.0, 4.0, 6.0, 7.0]}, {'self': 3.0, 'others': [2.0, 5.0, 5.0, 3.0, 8.0, 2.0, 3.0, 8.0, 7.0]}, {'self': 1.0, 'others': [1.0, 5.0, 3.0, 3.0, 2.0, 4.0, 1.0, 5.0, 7.0]}], 'profile': {'tightness': {'self': 2.0, 'others': [2.0, 3.0, 4.0, 2.0, 1.0, 1.0, 3.0, 5.0, 8.0]}, 'aggression': {'self': 5.0, 'others': [9.0, 5.0, 9.0, 4.0, 6.0, 4.0, 3.0, 5.0, 10.0]}}, 'aiAdvice': '\n        <p><strong>综合评价：</strong>你需要涅槃重生，所以称号是<strong>【凤凰】</strong>。你目前处于“自暴自弃”的状态：自评几乎全是1-2分，打法上又是公认的“松弱”（紧度公认3.2）。你玩得太宽，放弃得太快，毫无自信可言。</p>\n        <p><strong>战术建议：</strong></p>\n        <ul>\n            <li><strong>禁止Limp（平跟）：</strong>你最大的漏洞是被动入池。请立下规矩：要么加注，要么弃牌。这能瞬间提升你的形象和胜率。</li>\n            <li><strong>背诵表格：</strong>你的基础薄弱不是借口。熟背<strong>15BB推弃表</strong>，在短码时把决定权交给数学，而不是交给你那摇摆不定的心态。</li>\n        </ul>\n    '},










    ];

    // ============================================================================
    // 逻辑代码
    // ============================================================================

    const teamAverages = dimensions.map((_, idx) => {
        let sum = 0, count = 0;
        playersData.forEach(p => {
            sum += p.abilities[idx].self;
            count++;
            p.abilities[idx].others.forEach(v => {
                sum += v;
                count++;
            });
        });
        return (sum / count).toFixed(2);
    });

    let radarChart = null;
    let scatterChart = null;
    const playerSelect = document.getElementById('playerSelect');
    const stickySelect = document.getElementById('stickyPlayerSelect');
    const stickyHeader = document.getElementById('stickyHeader');
    const mainHeader = document.getElementById('mainHeader');
    const detailRows = document.getElementById('detailRows');
    const aiAdvice = document.getElementById('aiAdvice');
    const profileText = document.getElementById('profileText');
    const maeValueDisplay = document.getElementById('maeValue');
    const maeValueOtherDisplay = document.getElementById('maeOther');

    function populateSelects() {
        playersData.forEach((p, index) => {
            const opt1 = document.createElement('option');
            opt1.value = index;
            opt1.innerText = p.id;
            playerSelect.appendChild(opt1);
            const opt2 = document.createElement('option');
            opt2.value = index;
            opt2.innerText = p.id;
            stickySelect.appendChild(opt2);
        });
    }

    populateSelects();

    function handlePlayerChange(index) {
        playerSelect.value = index;
        stickySelect.value = index;
        updateDashboard(index);
    }

    playerSelect.addEventListener('change', (e) => handlePlayerChange(e.target.value));
    stickySelect.addEventListener('change', (e) => handlePlayerChange(e.target.value));

    window.addEventListener('scroll', () => {
        if (window.scrollY > mainHeader.offsetHeight + 20) stickyHeader.classList.add('visible');
        else stickyHeader.classList.remove('visible');
    });

    Chart.defaults.color = '#707570';
    Chart.defaults.borderColor = 'rgba(255,255,255,0.05)';
    Chart.defaults.font.family = "'Space Mono', 'PingFang SC', sans-serif";

    function initDetailRows() {
        const allLabels = [...dimensions, "松紧倾向", "激进倾向"];
        allLabels.forEach((label, i) => {
            const row = document.createElement('div');
            row.className = 'detail-row';
            row.dataset.index = i;
            row.innerHTML = `
                <div class="row-header">
                    <div class="d-label">${label}</div>
                    <div class="d-stats">
                        <span class="stat-item"><span class="stat-label-small">自</span><span class="stat-val" id="row-${i}-val-self">0</span></span>
                        <span class="stat-item"><span class="stat-label-small">他</span><span class="stat-val" id="row-${i}-val-other">0</span></span>
                        <span class="stat-item"><span class="stat-label-small">差</span><span class="stat-gap" id="row-${i}-val-diff">0</span></span>
                    </div>
                </div>
                <div class="d-track-container">
                    <div class="d-track-line"></div>
                    ${Array.from({length: 20}).map((_, j) => `<div class="detail-point peer" id="row-${i}-peer-${j}" style="display:none; left:50%"></div>`).join('')}
                    <div class="detail-point self" id="row-${i}-self" style="left:50%"></div>
                </div>
            `;
            detailRows.appendChild(row);
        });
    }

    initDetailRows();

    function updateDashboard(index) {
        const player = playersData[index];
        updateRadar(player);
        updateScatter(index);
        updateDetails(player);

        // [修改] 原来的: aiAdvice.innerHTML = player.aiAdvice;
        // --- AI 建议动效优化 ---
        // 1. 开始淡出并轻微“下沉”
        aiAdvice.style.opacity = 0;
        aiAdvice.style.transform = 'translateY(15px)';

        // 2. 等待淡出动画（约 300 毫秒），然后更新内容并“浮起”
        setTimeout(() => {
            aiAdvice.innerHTML = player.aiAdvice;
            aiAdvice.style.opacity = 1;
            aiAdvice.style.transform = 'translateY(0)'; // 恢复到原位
        }, 300); // 这个延迟时间略短于 CSS 的 400ms，以确保内容在淡出后更新

        // --- profileText 动画 (保持不变) ---
        profileText.style.opacity = 0;
        setTimeout(() => {
            profileText.innerText = player.profileLabel;
            profileText.style.transition = 'opacity 0.8s';
            profileText.style.opacity = 1;
        }, 200);

        animateValue(maeValueDisplay, parseFloat(player.mae), false);
        animateValue(maeValueOtherDisplay, parseFloat(player.maeOther), false);
    }

    function updateRadar(player) {
        const ctx = document.getElementById('radarChart').getContext('2d');
        const selfData = player.abilities.map(a => a.self);
        const otherAvgData = player.abilities.map(a => (a.others.reduce((x, y) => x + y, 0) / a.others.length).toFixed(1));

        const gradientSelf = ctx.createRadialGradient(200, 200, 0, 200, 200, 200);
        gradientSelf.addColorStop(0, 'rgba(197, 160, 89, 0.2)');
        gradientSelf.addColorStop(1, 'rgba(197, 160, 89, 0.05)');

        if (radarChart) {
            radarChart.data.datasets[0].data = selfData;
            radarChart.data.datasets[1].data = otherAvgData;
            radarChart.update({duration: 1500, easing: 'easeInOutQuart'});
        } else {
            radarChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: dimensions,
                    datasets: [
                        {
                            label: '自评    ',
                            data: selfData,
                            borderColor: '#C5A059',
                            backgroundColor: gradientSelf,
                            borderWidth: 2,
                            pointBackgroundColor: '#000',
                            pointBorderColor: '#C5A059',
                            pointBorderWidth: 2,
                            pointRadius: 3,
                            order: 1
                        },
                        {
                            label: '他评    ',
                            data: otherAvgData,
                            borderColor: '#707570',
                            backgroundColor: 'transparent',
                            borderDash: [3, 3],
                            borderWidth: 1,
                            pointBackgroundColor: '#707570',
                            pointRadius: 2,
                            order: 2
                        },
                        {
                            label: '全员平均',
                            data: teamAverages,
                            borderColor: 'transparent',
                            backgroundColor: 'rgba(255, 255, 255, 0.03)',
                            pointRadius: 2,
                            fill: true,
                            order: 3
                        }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: {color: 'rgba(255,255,255,0.03)'},
                            grid: {color: 'rgba(255,255,255,0.03)', circular: true},
                            pointLabels: {color: '#d0d0d0', font: {size: 12, family: "'Noto Serif SC', serif"}},
                            suggestedMin: 0, suggestedMax: 10, ticks: {display: false, stepSize: 2}
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: '#707570',
                                font: {family: "'Noto Serif SC', serif"},
                                boxWidth: 8,
                                usePointStyle: true
                            }
                        }
                    }
                }
            });
        }
    }

    function updateScatter(selectedIndex) {
        const ctx = document.getElementById('scatterChart').getContext('2d');
        const currentId = parseInt(selectedIndex);

        const allSelfPoints = [];
        const allOtherPoints = [];

        playersData.forEach((p, idx) => {
            const avgTight = p.profile.tightness.others.reduce((a, b) => a + b, 0) / p.profile.tightness.others.length;
            const avgAgg = p.profile.aggression.others.reduce((a, b) => a + b, 0) / p.profile.aggression.others.length;

            allSelfPoints.push({x: p.profile.tightness.self, y: p.profile.aggression.self, pIndex: idx});
            allOtherPoints.push({x: avgTight, y: avgAgg, pIndex: idx});
        });

        const glowPlugin = {
            id: 'glowEffect',
            beforeDatasetsDraw: (chart) => {
                const {ctx} = chart;
                const activeId = chart.options.activePlayerIndex;

                if (activeId === undefined || activeId === null) return;

                ctx.save();

                chart.data.datasets.forEach((dataset, datasetIndex) => {
                    const meta = chart.getDatasetMeta(datasetIndex);

                    meta.data.forEach((point, index) => {
                        const raw = dataset.data[index];
                        if (raw && raw.pIndex === activeId) {
                            const {x, y} = point.getProps(['x', 'y'], true);

                            if (datasetIndex === 0) {
                                ctx.shadowColor = '#C5A059';
                                ctx.shadowBlur = 20;
                                ctx.fillStyle = '#C5A059';
                            } else {
                                ctx.shadowColor = 'rgba(255, 255, 255, 0.8)';
                                ctx.shadowBlur = 15;
                                ctx.fillStyle = '#ffffff';
                            }

                            ctx.beginPath();
                            if (datasetIndex === 0) {
                                const size = 6;
                                ctx.moveTo(x, y - size);
                                ctx.lineTo(x + size, y);
                                ctx.lineTo(x, y + size);
                                ctx.lineTo(x - size, y);
                            } else {
                                ctx.arc(x, y, 4, 0, 2 * Math.PI);
                            }
                            ctx.closePath();
                            ctx.fill();
                        }
                    });
                });

                ctx.restore();
            }
        };

        const getColor = (context, isSelf) => {
            const raw = context.raw;
            if (!raw) return 'transparent';
            const isActive = raw.pIndex === currentId;
            if (isSelf) return isActive ? '#C5A059' : 'rgba(197, 160, 89, 0.15)';
            else return isActive ? '#e0e0e0' : 'rgba(255, 255, 255, 0.1)';
        };

        if (scatterChart) {
            scatterChart.options.activePlayerIndex = currentId;
            scatterChart.data.datasets[0].data = allSelfPoints;
            scatterChart.data.datasets[1].data = allOtherPoints;
            scatterChart.data.datasets[0].pointBackgroundColor = (c) => getColor(c, true);
            scatterChart.data.datasets[1].pointBackgroundColor = (c) => getColor(c, false);
            scatterChart.update();
        } else {
            Chart.register(glowPlugin);

            scatterChart = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [
                        {
                            // label 属性其实可以删掉了，因为不再显示自带图例
                            data: allSelfPoints,
                            pointBackgroundColor: (c) => getColor(c, true),
                            borderWidth: 0,
                            pointRadius: 6,
                            pointStyle: 'rectRot' // 菱形
                        },
                        {
                            data: allOtherPoints,
                            pointBackgroundColor: (c) => getColor(c, false),
                            borderWidth: 0,
                            pointRadius: 4
                        }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    layout: {padding: 10},
                    activePlayerIndex: currentId,
                    scales: {
                        x: {
                            min: 0, max: 10,
                            grid: {
                                color: (c) => c.tick.value === 5 ? 'rgba(255,255,255,0.15)' : 'rgba(255,255,255,0.02)',
                                lineWidth: (c) => c.tick.value === 5 ? 1 : 1
                            },
                            ticks: {display: false}, border: {display: false}
                        },
                        y: {
                            min: 0, max: 10,
                            grid: {
                                color: (c) => c.tick.value === 5 ? 'rgba(255,255,255,0.15)' : 'rgba(255,255,255,0.02)',
                                lineWidth: (c) => c.tick.value === 5 ? 1 : 1
                            },
                            ticks: {display: false}, border: {display: false}
                        }
                    },
                    plugins: {
                        // [关键修改] 彻底关闭自带图例
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: '#C5A059',
                            bodyColor: '#fff',
                            callbacks: {
                                label: function (context) {
                                    const pId = playersData[context.raw.pIndex].id.split(' ')[0];
                                    // 保留两位小数
                                    return `${pId}: (${context.raw.x.toFixed(2)}, ${context.raw.y.toFixed(2)})`;
                                }
                            }
                        }
                    }
                }
            });
        }
    }

    /**
     * 数字滚动动画函数
     * @param {HTMLElement} element - 要更新的 DOM 元素
     * @param {number} targetValue - 最终数值
     * @param {boolean} isInteger - 是否显示为整数 (默认 false，显示2位小数)
     * @param {number} duration - 动画时长 (毫秒)
     */
    function animateValue(element, targetValue, isInteger = false, duration = 800) {
        // 1. 获取当前显示的数值作为起点，如果无法解析则默认为 0
        const startValue = parseFloat(element.innerText) || 0;
        const startTime = performance.now();

        // 2. 定义每一帧的更新逻辑
        function update(currentTime) {
            const elapsed = currentTime - startTime;
            // 计算进度 (0 到 1)
            const progress = Math.min(elapsed / duration, 1);

            // 缓动效果 (Ease Out Cubic): 让动画开始快，结束慢，更自然
            const ease = 1 - Math.pow(1 - progress, 3);

            // 计算当前帧的数值
            const current = startValue + (targetValue - startValue) * ease;

            // 更新文字 (保留2位小数以实现滚动效果)
            element.innerText = isInteger ? Math.round(current) : current.toFixed(2);

            // 如果动画未结束，请求下一帧
            if (progress < 1) {
                requestAnimationFrame(update);
            } else {
                // 确保最终数值精确
                element.innerText = isInteger ? Math.round(targetValue) : targetValue.toFixed(2);
            }
        }

        // 3. 启动动画
        requestAnimationFrame(update);
    }

    function updateDetails(player) {
        const allDims = [
            ...player.abilities.map(a => ({self: a.self, others: a.others})),
            {self: player.profile.tightness.self, others: player.profile.tightness.others},
            {self: player.profile.aggression.self, others: player.profile.aggression.others},
        ];
        if (maeValueDisplay) animateValue(maeValueDisplay, maeValueDisplay, false); // 这里设为 true 最终显示整数，设为 false 显示 8.00
        if (maeValueOtherDisplay) animateValue(maeValueOtherDisplay, maeValueOtherDisplay, false); // 这里设为 true 最终显示整数，设为 false 显示 8.00

        allDims.forEach((item, i) => {
            const avg = (item.others.reduce((a, b) => a + b, 0) / item.others.length);
            const gap = Math.abs(item.self - avg);

            // --- 1. 处理进度条/圆点位置 (保持不变，这部分不需要数字动画) ---
            const selfDot = document.getElementById(`row-${i}-self`);
            if (selfDot) {
                // 建议在 CSS 中给 .marker-self 加 transition: left 0.6s ease; 这样圆点也会平滑移动
                selfDot.style.left = (item.self / 10) * 100 + '%';
            }

            for (let k = 0; k < 20; k++) {
                const p = document.getElementById(`row-${i}-peer-${k}`);
                if (p) p.style.display = 'none';
            }
            item.others.forEach((val, j) => {
                const peerDot = document.getElementById(`row-${i}-peer-${j}`);
                if (peerDot) {
                    peerDot.style.display = 'block';
                    const jitter = (Math.random() - 0.5) * 1.5;
                    const safeVal = Math.max(0, Math.min(100, (val / 10) * 100 + jitter));
                    peerDot.style.left = safeVal + '%';
                }
            });

            // --- 2. 处理数字动画 (修改部分) ---
            const elSelf = document.getElementById(`row-${i}-val-self`);
            const elOther = document.getElementById(`row-${i}-val-other`);
            const elDiff = document.getElementById(`row-${i}-val-diff`);

            // 使用 animateValue 替代直接赋值
            // item.self 通常是整数，如果你希望它也显示小数滚动效果，第三个参数传 false
            // 如果你希望自评分为整数，第三个参数传 true
            if (elSelf) animateValue(elSelf, item.self, true); // 这里设为 true 最终显示整数，设为 false 显示 8.00
            if (elOther) animateValue(elOther, avg, false);    // 平均分保留小数
            if (elDiff) animateValue(elDiff, gap, false);      // 差异保留小数


        });
    }

    updateDashboard(0);

</script>
</body>
</html>